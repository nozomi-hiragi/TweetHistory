# TweetHistory 仕様書

このドキュメントでは、Twitter アーカイブ内の `tweets.js` を閲覧・整理するアプリ
「TweetHistory」を実装するための要件をまとめます。Flutter 版と Next.js 版の二つの
フロントエンドを提供し、どちらからも同じ JSON 形式のデータを取り扱うことを想定しま
す。

## 1. 機能概要

- **ツイートのインポート**
  - Twitter から取得した `tweets.js` もしくはエクスポートした JSON ファイルを読み込み
    、内部データベースへ保存する。
- **ツイート一覧表示**
  - 取り込んだツイートを投稿日時の降順で表示する。
  - 画像が含まれる場合はサムネイルを表示する。
- **グループ分け**
  - 任意のグループを作成し、ツイート ID を紐付けて管理する。
- **削除・ゴミ箱**
  - 不要なツイートを一覧から削除し、後で復元できるようゴミ箱機能を用意する（今後拡張
    予定）。
- **データのエクスポート**
  - 現在のツイートとグループ情報を JSON として出力し、別環境へインポートできるように
    する。

## 2. 技術要素

### Flutter 版
- 状態管理は **Riverpod** を利用する。
- Web 版を主軸としつつ、iOS/Android ビルドも可能とする。
- データ保存にはブラウザ環境では `idb_shim` を用いて IndexedDB を利用する。
- 主要画面は `Tweets`・`Bin`・`Settings` のタブ構成とし、ツイートアップロードボタンを
  `Tweets` 画面の FAB として配置する。

### Next.js 版
- UI フレームワークに **Mantine** を使用する。
- ブラウザ側 DB として **Dexie.js** を利用し、ツイート・グループを IndexedDB に保存す
  る。
- React でツイートカード、グループ管理 UI、インポート／エクスポート UI を実装する。

## 3. データ形式

`tweets.js` から取り込むデータは以下のような JSON 配列を想定する。

```json
[
  {
    "tweet": {
      "id": "1234567890",
      "full_text": "ツイート本文",
      "created_at": "Wed May 01 12:34:56 +0000 2024",
      "entities": {
        "media": [
          { "media_url_https": "https://...", "type": "photo" }
        ]
      }
    }
  }
]
```

アプリ内部ではこれを整形し、ツイート ID や作成日時、メディア情報など必要な要素のみを
保持した `Tweet` モデルとして保存する。グループ情報は以下の構造で管理する。

```json
{
  "id": 1,
  "name": "旅行",
  "ids": ["1234567890", "987654321"]
}
```

## 4. 今後の拡張案

- ツイートの全文検索やフィルタリング機能
- グループごとのエクスポート／インポート
- ゴミ箱からの復元・完全削除
- モバイル向けのデザイン最適化

以上が TweetHistory 開発のための基本仕様です。実装時はこの文書をベースに必要に応じ
て機能を取捨選択し、具体的な UI 実装やデータ整合性の検討を進めてください。
